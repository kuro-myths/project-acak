<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Keren Audio-Visual Click</title>
<style>
    html,body{margin:0;height:100%;background:#111;overflow:hidden;cursor:pointer;font-family:sans-serif;color:#fff}
    canvas{position:absolute;top:0;left:0}
    #info{
        position:absolute;bottom:20px;width:100%;
        text-align:center;font-size:1.2rem;
        text-shadow:0 0 8px #0ff;
    }
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="info">Klik layar untuk ledakan partikel + synth drum!</div>

<script>
/* ---------- Setup Canvas ---------- */
const c = document.getElementById('c');
const ctx = c.getContext('2d');
resize();
window.addEventListener('resize', resize);
function resize(){
    c.width = innerWidth;
    c.height = innerHeight;
}

/* ---------- Partikel ---------- */
const particles = [];
class Particle {
    constructor(x,y){
        this.x = x;
        this.y = y;
        const angle = Math.random()*Math.PI*2;
        const speed = Math.random()*5 + 2;
        this.vx = Math.cos(angle)*speed;
        this.vy = Math.sin(angle)*speed;
        this.life = 1;
        this.decay = Math.random()*0.015 + 0.005;
        this.hue = Math.random()*360;
    }
    update(){
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.05; // gravity
        this.life -= this.decay;
    }
    draw(){
        ctx.save();
        ctx.globalAlpha = this.life;
        ctx.fillStyle = `hsl(${this.hue},100%,50%)`;
        ctx.beginPath();
        ctx.arc(this.x,this.y,3,0,Math.PI*2);
        ctx.fill();
        ctx.restore();
    }
}

/* ---------- Audio ---------- */
let audioCtx;
function initAudio(){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
}
function playKick(){
    if(!audioCtx) initAudio();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.type = 'triangle';
    osc.frequency.setValueAtTime(120, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(40, audioCtx.currentTime + 0.15);
    gain.gain.setValueAtTime(1, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.2);
}

/* ---------- Loop ---------- */
function animate(){
    ctx.fillStyle = 'rgba(0,0,0,0.1)';
    ctx.fillRect(0,0,c.width,c.height);
    particles.forEach((p,i)=>{
        p.update();
        p.draw();
        if(p.life <= 0) particles.splice(i,1);
    });
    requestAnimationFrame(animate);
}
animate();

/* ---------- Interaksi ---------- */
c.addEventListener('click', e=>{
    const {clientX:x, clientY:y} = e;
    playKick();
    for(let i=0;i<120;i++) particles.push(new Particle(x,y));
});
</script>
</body>
</html>
